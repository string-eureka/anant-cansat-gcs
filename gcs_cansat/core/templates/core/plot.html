{% extends 'core/base.html' %}
{% load static %}
{% block content %}

<p id="refresh-timer"></p>
<script src = "{% static 'core/refresh.js' %}"></script>

<div class="container-wrapper">
    <div class="left-container">
        <div style="text-align: center;">
            <h2>Packets</h2>
            <p>{{PACKET_COUNT_s|last}}</p>
            <h2>Time</h2>
            <p>{{TIME_s|last}}</p>
            <h2>Flight Software State</h2>
            <p>{state}</p>
            <button id="startButton">Toggle Plotting</button>
        </div>
    </div>
    
    <div class="right-container">
        <div class="chart-row">
            <div class="chart-col ">
                <div class="chartAreaWrappers"></div>
                <canvas id="altitudeChart" class="chart"></canvas>
            </div>
            <div class="chart-col">
                <canvas id="tempChart" class="chart"></canvas>
            </div>
        </div>
        <div class="chart-row">
            <div class="chart-col">
                <canvas id="accelChart" class="chart"></canvas>
            </div>
            <div class="chart-col">
                <canvas id="voltageChart" class="chart"></canvas>
            </div>
        </div>
        <div class="chart-row">
            <div class="chart-col">
                <canvas id="gnssChart" class="chart"></canvas>
            </div>
            <div class="chart-col">
                <canvas id="gyroChart" class="chart"></canvas>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>  
    document.addEventListener('DOMContentLoaded', function () {
        var altitudeCtx = document.getElementById('altitudeChart').getContext('2d');
        var altitudeChart = new Chart(altitudeCtx, {
                        type: 'line',
            options: {
                animation: {
                    duration: 0
            }
        },
            data: {
                labels: {{ TIME_s|safe }},
                datasets: [{
                    label: 'Altitude (m)',
                    data: {{ ALTITUDE_s|safe }},
                    borderColor: 'blue',
                    borderWidth: 1,
                    fill: false
                }]
            }
        });

        var tempCtx = document.getElementById('tempChart').getContext('2d');
        var tempChart = new Chart(tempCtx, {
                        type: 'line',
            options: {
                animation: {
                    duration: 0
            }
        },
            data: {
                labels: {{ TIME_s|safe }},
                datasets: [{
                    label: 'Temperature (C)',
                    data: {{ TEMP_s|safe }},
                    borderColor: 'green',
                    borderWidth: 1,
                    fill: false
                }]
            }
        });

        var accelCtx = document.getElementById('accelChart').getContext('2d');
        var accelChart = new Chart(accelCtx, {
                        type: 'line',
            options: {
                animation: {
                    duration: 0
            }
        },
            data: {
                labels: {{ TIME_s|safe }},
                datasets: [{
                    label: 'Accelerometer X',
                    data: {{ ACCEL_X_s|safe }},
                    borderColor: 'red',
                    borderWidth: 1,
                    fill: false
                },{
                    label: 'Accelerometer Y',
                    data: {{ ACCEL_Y_s|safe }},
                    borderColor: 'blue',
                    borderWidth: 1,
                    fill: false
                },{
                    label: 'Accelerometer Z',
                    data: {{ ACCEL_Z_s|safe }},
                    borderColor: 'green',
                    borderWidth: 1,
                    fill: false
                }]
            }
        });

        var voltageCtx = document.getElementById('voltageChart').getContext('2d');
        var voltageChart = new Chart(voltageCtx, {
                        type: 'line',
            options: {
                animation: {
                    duration: 0
            }
        },
            data: {
                labels: {{ TIME_s|safe }},
                datasets: [{
                    label: 'Voltage',
                    data: {{ VOLTAGE_s|safe }},
                    borderColor: 'purple',
                    borderWidth: 1,
                    fill: false
                }]
            }
        });

        var gnssCtx = document.getElementById('gnssChart').getContext('2d');
        var gnssChart = new Chart(gnssCtx, {
                        type: 'line',
            options: {
                animation: {
                    duration: 0
            }
        },
            data: {
                labels: {{ TIME_s|safe }},
                datasets: [{
                    label: 'GNSS Satellites',
                    data: {{ GNSS_SATS_s|safe }},
                    borderColor: 'orange',
                    borderWidth: 1,
                    fill: false
                }]
            }
        });

        var gyroCtx = document.getElementById('gyroChart').getContext('2d');
        var gyroChart = new Chart(gyroCtx, {
                        type: 'line',
            options: {
                animation: {
                    duration: 0
            }
        },
            data: {
                labels: {{ TIME_s|safe }},
                datasets: [{
                    label: 'Gyroscope X',
                    data: {{ GYRO_X_s|safe }},
                    borderColor: 'brown',
                    borderWidth: 1,
                    fill: false
                },{
                    label: 'Gyroscope Y',
                    data: {{ GYRO_Y_s|safe }},
                    borderColor: 'black',
                    borderWidth: 1,
                    fill: false
                },{
                    label: 'Gyroscope Z',
                    data: {{ GYRO_Z_s|safe }},
                    borderColor: 'gray',
                    borderWidth: 1,
                    fill: false
                }]
            }
        });
    });
</script>

{% endblock %}